---
title: "R Notebook"
output: html_notebook
---

On va essayer de regarder pour un petit échantillon de données
```{r}
rm(list = objects())
setwd("D:/Documents/Etudes/StatML/Projet_ML/StatML_ProjectML")
library(httr)
library(jsonlite)
library(tidyverse)
```

```{r}
stations = read_delim("../Data/Liste_Stations.csv")
stations_Seine = stations %>% filter(libelle_cours_eau == "La Seine")
write_delim(stations %>% filter(libelle_cours_eau == "La Seine"),
            "../Data/Stations_Seine.csv",
            delim = ";")

cont = TRUE
index_station = 1
while(cont){
  res = GET("https://hubeau.eaufrance.fr/api/v1/hydrometrie/observations_tr.csv",
          query = list(code_entite = stations_Seine$code_station[index_station]))
  data = read_delim(res$content)
  if (nrow(data) == 0){
    index_station = index_station+1
  } else{
    cont = FALSE
  }
}
index_station # 4
plot(data$date_obs, data$resultat_obs)
data
```
